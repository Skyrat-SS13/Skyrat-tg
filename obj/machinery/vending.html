<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><base href="../../"><link rel="stylesheet" href="dmdoc.css"><title>/obj/machinery/vending - /tg/ Station 13</title></head><body><header><a href="index.html">/tg/ Station 13</a> - <a href="index.html#modules">Modules</a> - <a href="index.html#types">Types</a> — <a href="obj/machinery/vending.html#var">Var Details</a> - <a href="obj/machinery/vending.html#proc">Proc Details</a></header><main><h1>vending machines <aside>/<a href="obj.html">obj</a>/<a href="obj/machinery.html">machinery</a>/<a href="obj/machinery/vending.html">vending</a></aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L55"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 55"></a></h1><p>Captalism in the year 2525, everything in a vending machine, even love</p><table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr><tr><th><a href="obj/machinery/vending.html#var/active">active</a></th><td>Is the machine active (No sales pitches if off)!</td></tr><tr><th><a href="obj/machinery/vending.html#var/age_restrictions">age_restrictions</a></th><td>Whether our age check is currently functional</td></tr><tr><th><a href="obj/machinery/vending.html#var/bill">bill</a></th><td>Bills we accept?</td></tr><tr><th><a href="obj/machinery/vending.html#var/coin">coin</a></th><td>Coins that we accept?</td></tr><tr><th><a href="obj/machinery/vending.html#var/coin_records">coin_records</a></th><td>List of premium product records</td></tr><tr><th><a href="obj/machinery/vending.html#var/contraband">contraband</a></th><td>List of products this machine sells when you hack it</td></tr><tr><th><a href="obj/machinery/vending.html#var/credits_contained">credits_contained</a></th><td>How many credits does this vending machine have? 20% of all sales go to this pool, and are given freely when the machine is restocked, or successfully tilted. Lost on deconstruction.</td></tr><tr><th><a href="obj/machinery/vending.html#var/crit_chance">crit_chance</a></th><td>The chance, in percent, of this vendor performing a critical hit on anything it crushes via [tilt].</td></tr><tr><th><a href="obj/machinery/vending.html#var/default_price">default_price</a></th><td>Default price of items if not overridden</td></tr><tr><th><a href="obj/machinery/vending.html#var/displayed_currency_icon">displayed_currency_icon</a></th><td>fontawesome icon name to use in to display the user's balance in the vendor UI</td></tr><tr><th><a href="obj/machinery/vending.html#var/displayed_currency_name">displayed_currency_name</a></th><td>String of the used currency to display in the vendor UI</td></tr><tr><th><a href="obj/machinery/vending.html#var/excluded_products">excluded_products</a></th><td>list of products to exclude when building the vending machine's inventory</td></tr><tr><th><a href="obj/machinery/vending.html#var/extended_inventory">extended_inventory</a></th><td>can we access the hidden inventory?</td></tr><tr><th><a href="obj/machinery/vending.html#var/extra_price">extra_price</a></th><td>Default price of premium items if not overridden</td></tr><tr><th><a href="obj/machinery/vending.html#var/forcecrit">forcecrit</a></th><td>If set to a critical define in crushing.dm, anything this vendor crushes will always be hit with that effect.</td></tr><tr><th><a href="obj/machinery/vending.html#var/hidden_records">hidden_records</a></th><td>List of contraband product records</td></tr><tr><th><a href="obj/machinery/vending.html#var/icon_deny">icon_deny</a></th><td>Icon to flash when user is denied a vend</td></tr><tr><th><a href="obj/machinery/vending.html#var/icon_vend">icon_vend</a></th><td>Icon when vending an item to the user</td></tr><tr><th><a href="obj/machinery/vending.html#var/last_reply">last_reply</a></th><td>Last world tick we sent a vent reply</td></tr><tr><th><a href="obj/machinery/vending.html#var/last_shopper">last_shopper</a></th><td>The ref of the last mob to shop with us</td></tr><tr><th><a href="obj/machinery/vending.html#var/last_slogan">last_slogan</a></th><td>Last world tick we sent a slogan message out</td></tr><tr><th><a href="obj/machinery/vending.html#var/light_mask">light_mask</a></th><td>Name of lighting mask for the vending machine</td></tr><tr><th><a href="obj/machinery/vending.html#var/loaded_items">loaded_items</a></th><td>how many items have been inserted in a vendor</td></tr><tr><th><a href="obj/machinery/vending.html#var/num_shards">num_shards</a></th><td>Number of glass shards the vendor creates and tries to embed into an atom it tilted onto</td></tr><tr><th><a href="obj/machinery/vending.html#var/onstation">onstation</a></th><td>Is this item on station or not</td></tr><tr><th><a href="obj/machinery/vending.html#var/onstation_override">onstation_override</a></th><td>A variable to change on a per instance basis on the map that allows the instance
to ignore whether it's on the station or not.
Useful to force cost and ID requirements. DO NOT APPLY THIS GLOBALLY.</td></tr><tr><th><a href="obj/machinery/vending.html#var/panel_type">panel_type</a></th><td>Icon for the maintenance panel overlay</td></tr><tr><th><a href="obj/machinery/vending.html#var/pinned_mobs">pinned_mobs</a></th><td>List of mobs stuck under the vendor</td></tr><tr><th><a href="obj/machinery/vending.html#var/premium">premium</a></th><td>List of premium products this machine sells</td></tr><tr><th><a href="obj/machinery/vending.html#var/product_ads">product_ads</a></th><td>String of small ad messages in the vending screen - random chance</td></tr><tr><th><a href="obj/machinery/vending.html#var/product_categories">product_categories</a></th><td>List of products this machine sells, categorized.
Can only be used as an alternative to <code>products</code>, not alongside it.</td></tr><tr><th><a href="obj/machinery/vending.html#var/product_records">product_records</a></th><td>List of standard product records</td></tr><tr><th><a href="obj/machinery/vending.html#var/product_slogans">product_slogans</a></th><td>String of slogans separated by semicolons, optional</td></tr><tr><th><a href="obj/machinery/vending.html#var/products">products</a></th><td>List of products this machine sells</td></tr><tr><th><a href="obj/machinery/vending.html#var/purchase_message_cooldown">purchase_message_cooldown</a></th><td>Next world time to send a purchase message</td></tr><tr><th><a href="obj/machinery/vending.html#var/scan_id">scan_id</a></th><td>Are we checking the users ID</td></tr><tr><th><a href="obj/machinery/vending.html#var/sec_radio">sec_radio</a></th><td>used for narcing on underages</td></tr><tr><th><a href="obj/machinery/vending.html#var/seconds_electrified">seconds_electrified</a></th><td>World ticks the machine is electified for</td></tr><tr><th><a href="obj/machinery/vending.html#var/shoot_inventory">shoot_inventory</a></th><td>When this is TRUE, we fire items at customers! We're broken!</td></tr><tr><th><a href="obj/machinery/vending.html#var/shoot_inventory_chance">shoot_inventory_chance</a></th><td>How likely this is to happen (prob 100) per second</td></tr><tr><th><a href="obj/machinery/vending.html#var/skyrat_contraband">skyrat_contraband</a></th><td>Additions to the <code>contraband</code> list  of the vending machine, modularly. Will become null after Initialize, to free up memory.</td></tr><tr><th><a href="obj/machinery/vending.html#var/skyrat_premium">skyrat_premium</a></th><td>Additions to the <code>premium</code> list  of the vending machine, modularly. Will become null after Initialize, to free up memory.</td></tr><tr><th><a href="obj/machinery/vending.html#var/skyrat_product_categories">skyrat_product_categories</a></th><td>Additions to the <code>product_categories</code> list of the vending machine, modularly. Will become null after Initialize, to free up memory.</td></tr><tr><th><a href="obj/machinery/vending.html#var/skyrat_products">skyrat_products</a></th><td>Additions to the <code>products</code> list  of the vending machine, modularly. Will become null after Initialize, to free up memory.</td></tr><tr><th><a href="obj/machinery/vending.html#var/slogan_delay">slogan_delay</a></th><td>How many ticks until we can send another</td></tr><tr><th><a href="obj/machinery/vending.html#var/slogan_list">slogan_list</a></th><td>List of slogans to scream at potential customers; built upon Iniitialize() of the vendor from product_slogans</td></tr><tr><th><a href="obj/machinery/vending.html#var/squish_damage">squish_damage</a></th><td>Damage this vendor does when tilting onto an atom</td></tr><tr><th><a href="obj/machinery/vending.html#var/tiltable">tiltable</a></th><td>Whether this vendor can be tilted over or not</td></tr><tr><th><a href="obj/machinery/vending.html#var/tilted">tilted</a></th><td>Whether the vendor is tilted or not</td></tr><tr><th><a href="obj/machinery/vending.html#var/tilted_rotation">tilted_rotation</a></th><td>If tilted, this variable should always be the rotation that was applied when we were tilted. Stored for the purposes of unapplying it.</td></tr><tr><th><a href="obj/machinery/vending.html#var/vend_ready">vend_ready</a></th><td>Are we ready to vend?? Is it time??</td></tr><tr><th><a href="obj/machinery/vending.html#var/vend_reply">vend_reply</a></th><td>Message sent post vend (Thank you for shopping!)</td></tr><tr><th><a href="obj/machinery/vending.html#var/vending_machine_input">vending_machine_input</a></th><td>Items that the players have loaded into the vendor</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr><tr><th><a href="obj/machinery/vending.html#proc/allow_increase">allow_increase</a></th><td>This proc checks for forbidden traits cause it'd be pretty bad to have 5 insuls available to assistants roundstart at the vendor!</td></tr><tr><th><a href="obj/machinery/vending.html#proc/atom_break">atom_break</a></th><td>Intentionally leaving out a case for zero credits as it should be covered by the vending machine's stock being full,
or covered by first case if items were returned.</td></tr><tr><th><a href="obj/machinery/vending.html#proc/build_inventories">build_inventories</a></th><td>*Builds all available inventories for the vendor - standard, contraband and premium</td></tr><tr><th><a href="obj/machinery/vending.html#proc/build_inventory">build_inventory</a></th><td>Build the inventory of the vending machine from its product and record lists</td></tr><tr><th><a href="obj/machinery/vending.html#proc/build_products_from_categories">build_products_from_categories</a></th><td>Populates list of products with categorized products</td></tr><tr><th><a href="obj/machinery/vending.html#proc/canLoadItem">canLoadItem</a></th><td>Are we able to load the item passed in</td></tr><tr><th><a href="obj/machinery/vending.html#proc/can_vend">can_vend</a></th><td>Whether this vendor can vend items or not.
arguments:
user - current customer</td></tr><tr><th><a href="obj/machinery/vending.html#proc/collect_records_for_static_data">collect_records_for_static_data</a></th><td>Returns a list of given product records of the vendor to be used in UI.
arguments:
records - list of records available
categories - list of categories available
premium - bool of whether a record should be priced by a custom/premium price or not</td></tr><tr><th><a href="obj/machinery/vending.html#proc/compartmentLoadAccessCheck">compartmentLoadAccessCheck</a></th><td>Is the passed in user allowed to load this vending machines compartments? This only is ran if we are using a /obj/item/storage/bag to load the vending machine, and not a dedicated restocker.</td></tr><tr><th><a href="obj/machinery/vending.html#proc/create_categories_from">create_categories_from</a></th><td>Returns a list of data about the category
Arguments:
name - string for the name of the category
icon - string for the fontawesome icon to use in the UI for the category
products - list of products available in the category</td></tr><tr><th><a href="obj/machinery/vending.html#proc/deploy_credits">deploy_credits</a></th><td>Drop credits when the vendor is attacked.</td></tr><tr><th><a href="obj/machinery/vending.html#proc/fetch_balance_to_use">fetch_balance_to_use</a></th><td>Returns the balance that the vendor will use for proceeding payment. Most vendors would want to use the user's
card's account credits balance.
arguments:
passed_id - the id card that will be billed for the product</td></tr><tr><th><a href="obj/machinery/vending.html#proc/freebie">freebie</a></th><td>Dispenses free items from the standard stock.
Arguments:
freebies - number of free items to vend</td></tr><tr><th><a href="obj/machinery/vending.html#proc/loadingAttempt">loadingAttempt</a></th><td>Tries to insert the item into the vendor, and depending on whether the product is a part of the vendor's
stock or not, increments an already present product entry's available amount or creates a new entry.
arguments:
inserted_item - the item we're trying to insert
user - mob who's trying to insert the item</td></tr><tr><th><a href="obj/machinery/vending.html#proc/on_dispense">on_dispense</a></th><td>A proc meant to perform custom behavior on newly dispensed items.</td></tr><tr><th><a href="obj/machinery/vending.html#proc/post_restock">post_restock</a></th><td>After-effects of refilling a vending machine from a refill canister</td></tr><tr><th><a href="obj/machinery/vending.html#proc/pre_throw">pre_throw</a></th><td>A callback called before an item is tossed out</td></tr><tr><th><a href="obj/machinery/vending.html#proc/proceed_payment">proceed_payment</a></th><td>Handles payment processing: discounts, logging, balance change etc.
arguments:
paying_id_card - the id card that will be billed for the product.
mob_paying - the mob that is trying to purchase the item.
product_to_vend - the product record of the item we're trying to vend.
price_to_use - price of the item we're trying to vend.</td></tr><tr><th><a href="obj/machinery/vending.html#proc/refill_inventory">refill_inventory</a></th><td>Refill our inventory from the passed in product list into the record list</td></tr><tr><th><a href="obj/machinery/vending.html#proc/remove_products">remove_products</a></th><td>GHOST CAFE WARDROBES
Removes given list of products. Must be called before build_inventory() to actually prevent the records from being created.</td></tr><tr><th><a href="obj/machinery/vending.html#proc/reset_prices">reset_prices</a></th><td>Reassign the prices of the vending machine as a result of the inflation value, as provided by SSeconomy</td></tr><tr><th><a href="obj/machinery/vending.html#proc/restock">restock</a></th><td>Refill a vending machine from a refill canister</td></tr><tr><th><a href="obj/machinery/vending.html#proc/select_colors">select_colors</a></th><td>Brings up a color config menu for the picked greyscaled item</td></tr><tr><th><a href="obj/machinery/vending.html#proc/shock">shock</a></th><td>Shock the passed in user</td></tr><tr><th><a href="obj/machinery/vending.html#proc/speak">speak</a></th><td>Speak the given message verbally</td></tr><tr><th><a href="obj/machinery/vending.html#proc/throw_impact">throw_impact</a></th><td>Crush the mob that the vending machine got thrown at</td></tr><tr><th><a href="obj/machinery/vending.html#proc/throw_item">throw_item</a></th><td>Throw an item from our internal inventory out in front of us</td></tr><tr><th><a href="obj/machinery/vending.html#proc/tilt">tilt</a></th><td>Tilts ontop of the atom supplied, if crit is true some extra shit can happen. See [fall_and_crush] for return values.
Arguments:
fatty - atom to tilt the vendor onto
local_crit_chance - percent chance of a critical hit
forced_crit - specific critical hit case to use, if any</td></tr><tr><th><a href="obj/machinery/vending.html#proc/total_loaded_stock">total_loaded_stock</a></th><td>Returns the total amount of items in the vending machine based on the product records and premium records, but not contraband</td></tr><tr><th><a href="obj/machinery/vending.html#proc/total_max_stock">total_max_stock</a></th><td>Returns the total amount of items in the vending machine based on the product records and premium records, but not contraband</td></tr><tr><th><a href="obj/machinery/vending.html#proc/unbuild_inventory">unbuild_inventory</a></th><td>Given a record list, go through and return a list of products in format of type -&gt; amount
Arguments:
recordlist - list of records to unbuild products from</td></tr><tr><th><a href="obj/machinery/vending.html#proc/unbuild_inventory_into">unbuild_inventory_into</a></th><td>Unbuild product_records into categorized product lists to the machine's refill canister.
Does not handle contraband/premium products, only standard stock and any other categories used by the vendor(see: ClothesMate).
If a product has no category, puts it into standard stock category.
Arguments:
product_records - list of products of the vendor
products - list of products of the refill canister
product_categories - list of product categories of the refill canister</td></tr><tr><th><a href="obj/machinery/vending.html#proc/untilt">untilt</a></th><td>Rights the vendor up, unpinning mobs under it, if any.
Arguments:
user - mob that has untilted the vendor</td></tr><tr><th><a href="obj/machinery/vending.html#proc/update_canister">update_canister</a></th><td>Set up a refill canister that matches this machine's products</td></tr><tr><th><a href="obj/machinery/vending.html#proc/vend">vend</a></th><td>The entire shebang of vending the picked item. Processes the vending and initiates the payment for the item.
arguments:
greyscale_colors - greyscale config for the item we're about to vend, if any</td></tr><tr><th><a href="obj/machinery/vending.html#proc/vend_greyscale">vend_greyscale</a></th><td>Vends a greyscale modified item.
arguments:
menu - greyscale config menu that has been used to vend the item</td></tr></table><h2 id="var">Var Details</h2><h3 id="var/active"><aside class="declaration">var </aside>active <aside>– </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L75"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 75"></a></h3><p>Is the machine active (No sales pitches if off)!</p><h3 id="var/age_restrictions"><aside class="declaration">var </aside>age_restrictions <aside>– </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L184"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 184"></a></h3><p>Whether our age check is currently functional</p><h3 id="var/bill"><aside class="declaration">var </aside>bill <aside>– /<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/<a href="obj/item/stack.html">stack</a>/spacecash</aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L174"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 174"></a></h3><p>Bills we accept?</p><h3 id="var/coin"><aside class="declaration">var </aside>coin <aside>– /<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/<a href="obj/item/coin.html">coin</a></aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L172"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 172"></a></h3><p>Coins that we accept?</p><h3 id="var/coin_records"><aside class="declaration">var </aside>coin_records <aside>– /list</aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L144"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 144"></a></h3><p>List of premium product records</p><h3 id="var/contraband"><aside class="declaration">var </aside>contraband <aside>– /list</aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L125"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 125"></a></h3><p>List of products this machine sells when you hack it</p>
<p>form should be list(/type/path = amount, /type/path2 = amount2)</p><h3 id="var/credits_contained"><aside class="declaration">var </aside>credits_contained <aside>– </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L186"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 186"></a></h3><p>How many credits does this vending machine have? 20% of all sales go to this pool, and are given freely when the machine is restocked, or successfully tilted. Lost on deconstruction.</p><h3 id="var/crit_chance"><aside class="declaration">var </aside>crit_chance <aside>– </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L91"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 91"></a></h3><p>The chance, in percent, of this vendor performing a critical hit on anything it crushes via [tilt].</p><h3 id="var/default_price"><aside class="declaration">var </aside>default_price <aside>– </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L176"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 176"></a></h3><p>Default price of items if not overridden</p><h3 id="var/displayed_currency_icon"><aside class="declaration">var </aside>displayed_currency_icon <aside>– </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L180"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 180"></a></h3><p>fontawesome icon name to use in to display the user's balance in the vendor UI</p><h3 id="var/displayed_currency_name"><aside class="declaration">var </aside>displayed_currency_name <aside>– </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L182"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 182"></a></h3><p>String of the used currency to display in the vendor UI</p><h3 id="var/excluded_products"><aside class="declaration">var </aside>excluded_products <aside>– /list</aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/modular_skyrat/modules/modular_vending/code/wardrobes.dm#L188"><img src="git.png" width="16" height="16" title="modular_skyrat/modules/modular_vending/code/wardrobes.dm 188"></a></h3><p>list of products to exclude when building the vending machine's inventory</p><h3 id="var/extended_inventory"><aside class="declaration">var </aside>extended_inventory <aside>– </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L168"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 168"></a></h3><p>can we access the hidden inventory?</p><h3 id="var/extra_price"><aside class="declaration">var </aside>extra_price <aside>– </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L178"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 178"></a></h3><p>Default price of premium items if not overridden</p><h3 id="var/forcecrit"><aside class="declaration">var </aside>forcecrit <aside>– </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L93"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 93"></a></h3><p>If set to a critical define in crushing.dm, anything this vendor crushes will always be hit with that effect.</p><h3 id="var/hidden_records"><aside class="declaration">var </aside>hidden_records <aside>– /list</aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L142"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 142"></a></h3><p>List of contraband product records</p><h3 id="var/icon_deny"><aside class="declaration">var </aside>icon_deny <aside>– </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L158"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 158"></a></h3><p>Icon to flash when user is denied a vend</p><h3 id="var/icon_vend"><aside class="declaration">var </aside>icon_vend <aside>– </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L156"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 156"></a></h3><p>Icon when vending an item to the user</p><h3 id="var/last_reply"><aside class="declaration">var </aside>last_reply <aside>– </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L150"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 150"></a></h3><p>Last world tick we sent a vent reply</p><h3 id="var/last_shopper"><aside class="declaration">var </aside>last_shopper <aside>– </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L81"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 81"></a></h3><p>The ref of the last mob to shop with us</p><h3 id="var/last_slogan"><aside class="declaration">var </aside>last_slogan <aside>– </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L152"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 152"></a></h3><p>Last world tick we sent a slogan message out</p><h3 id="var/light_mask"><aside class="declaration">var </aside>light_mask <aside>– </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L211"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 211"></a></h3><p>Name of lighting mask for the vending machine</p><h3 id="var/loaded_items"><aside class="declaration">var </aside>loaded_items <aside>– </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L208"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 208"></a></h3><p>how many items have been inserted in a vendor</p><h3 id="var/num_shards"><aside class="declaration">var </aside>num_shards <aside>– </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L95"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 95"></a></h3><p>Number of glass shards the vendor creates and tries to embed into an atom it tilted onto</p><h3 id="var/onstation"><aside class="declaration">var </aside>onstation <aside>– </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L193"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 193"></a></h3><p>Is this item on station or not</p>
<p>if it doesn't originate from off-station during mapload, everything is free
if it's off-station during mapload, it's also safe from the brand intelligence event</p><h3 id="var/onstation_override"><aside class="declaration">var </aside>onstation_override <aside>– </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L199"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 199"></a></h3><p>A variable to change on a per instance basis on the map that allows the instance
to ignore whether it's on the station or not.
Useful to force cost and ID requirements. DO NOT APPLY THIS GLOBALLY.</p><h3 id="var/panel_type"><aside class="declaration">var </aside>panel_type <aside>– </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L99"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 99"></a></h3><p>Icon for the maintenance panel overlay</p><h3 id="var/pinned_mobs"><aside class="declaration">var </aside>pinned_mobs <aside>– /list</aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L97"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 97"></a></h3><p>List of mobs stuck under the vendor</p><h3 id="var/premium"><aside class="declaration">var </aside>premium <aside>– /list</aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L132"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 132"></a></h3><p>List of premium products this machine sells</p>
<p>form should be list(/type/path = amount, /type/path2 = amount2)</p><h3 id="var/product_ads"><aside class="declaration">var </aside>product_ads <aside>– </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L137"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 137"></a></h3><p>String of small ad messages in the vending screen - random chance</p><h3 id="var/product_categories"><aside class="declaration">var </aside>product_categories <aside>– /list</aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L118"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 118"></a></h3><p>List of products this machine sells, categorized.
Can only be used as an alternative to <code>products</code>, not alongside it.</p>
<p>Form should be list(
&quot;name&quot; = &quot;Category Name&quot;,
&quot;icon&quot; = &quot;UI Icon (Font Awesome or tgfont)&quot;,
&quot;products&quot; = list(/type/path = amount, ...),
)</p><h3 id="var/product_records"><aside class="declaration">var </aside>product_records <aside>– /list</aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L140"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 140"></a></h3><p>List of standard product records</p><h3 id="var/product_slogans"><aside class="declaration">var </aside>product_slogans <aside>– </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L135"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 135"></a></h3><p>String of slogans separated by semicolons, optional</p><h3 id="var/products"><aside class="declaration">var </aside>products <aside>– /list</aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L106"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 106"></a></h3><p>List of products this machine sells</p>
<p>form should be list(/type/path = amount, /type/path2 = amount2)</p><h3 id="var/purchase_message_cooldown"><aside class="declaration">var </aside>purchase_message_cooldown <aside>– </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L79"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 79"></a></h3><p>Next world time to send a purchase message</p><h3 id="var/scan_id"><aside class="declaration">var </aside>scan_id <aside>– </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L170"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 170"></a></h3><p>Are we checking the users ID</p><h3 id="var/sec_radio"><aside class="declaration">var </aside>sec_radio <aside>– /<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/<a href="obj/item/radio.html">radio</a></aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L216"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 216"></a></h3><p>used for narcing on underages</p><h3 id="var/seconds_electrified"><aside class="declaration">var </aside>seconds_electrified <aside>– </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L160"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 160"></a></h3><p>World ticks the machine is electified for</p><h3 id="var/shoot_inventory"><aside class="declaration">var </aside>shoot_inventory <aside>– </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L162"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 162"></a></h3><p>When this is TRUE, we fire items at customers! We're broken!</p><h3 id="var/shoot_inventory_chance"><aside class="declaration">var </aside>shoot_inventory_chance <aside>– </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L164"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 164"></a></h3><p>How likely this is to happen (prob 100) per second</p><h3 id="var/skyrat_contraband"><aside class="declaration">var </aside>skyrat_contraband <aside>– /list</aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/modular_skyrat/modules/modular_vending/code/vending.dm#L13"><img src="git.png" width="16" height="16" title="modular_skyrat/modules/modular_vending/code/vending.dm 13"></a></h3><p>Additions to the <code>contraband</code> list  of the vending machine, modularly. Will become null after Initialize, to free up memory.</p><h3 id="var/skyrat_premium"><aside class="declaration">var </aside>skyrat_premium <aside>– /list</aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/modular_skyrat/modules/modular_vending/code/vending.dm#L9"><img src="git.png" width="16" height="16" title="modular_skyrat/modules/modular_vending/code/vending.dm 9"></a></h3><p>Additions to the <code>premium</code> list  of the vending machine, modularly. Will become null after Initialize, to free up memory.</p><h3 id="var/skyrat_product_categories"><aside class="declaration">var </aside>skyrat_product_categories <aside>– /list</aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/modular_skyrat/modules/modular_vending/code/vending.dm#L7"><img src="git.png" width="16" height="16" title="modular_skyrat/modules/modular_vending/code/vending.dm 7"></a></h3><p>Additions to the <code>product_categories</code> list of the vending machine, modularly. Will become null after Initialize, to free up memory.</p><h3 id="var/skyrat_products"><aside class="declaration">var </aside>skyrat_products <aside>– /list</aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/modular_skyrat/modules/modular_vending/code/vending.dm#L5"><img src="git.png" width="16" height="16" title="modular_skyrat/modules/modular_vending/code/vending.dm 5"></a></h3><p>Additions to the <code>products</code> list  of the vending machine, modularly. Will become null after Initialize, to free up memory.</p><h3 id="var/slogan_delay"><aside class="declaration">var </aside>slogan_delay <aside>– </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L154"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 154"></a></h3><p>How many ticks until we can send another</p><h3 id="var/slogan_list"><aside class="declaration">var </aside>slogan_list <aside>– /list</aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L146"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 146"></a></h3><p>List of slogans to scream at potential customers; built upon Iniitialize() of the vendor from product_slogans</p><h3 id="var/squish_damage"><aside class="declaration">var </aside>squish_damage <aside>– </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L89"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 89"></a></h3><p>Damage this vendor does when tilting onto an atom</p><h3 id="var/tiltable"><aside class="declaration">var </aside>tiltable <aside>– </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L87"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 87"></a></h3><p>Whether this vendor can be tilted over or not</p><h3 id="var/tilted"><aside class="declaration">var </aside>tilted <aside>– </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L83"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 83"></a></h3><p>Whether the vendor is tilted or not</p><h3 id="var/tilted_rotation"><aside class="declaration">var </aside>tilted_rotation <aside>– </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L85"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 85"></a></h3><p>If tilted, this variable should always be the rotation that was applied when we were tilted. Stored for the purposes of unapplying it.</p><h3 id="var/vend_ready"><aside class="declaration">var </aside>vend_ready <aside>– </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L77"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 77"></a></h3><p>Are we ready to vend?? Is it time??</p><h3 id="var/vend_reply"><aside class="declaration">var </aside>vend_reply <aside>– </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L148"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 148"></a></h3><p>Message sent post vend (Thank you for shopping!)</p><h3 id="var/vending_machine_input"><aside class="declaration">var </aside>vending_machine_input <aside>– /list</aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L202"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 202"></a></h3><p>Items that the players have loaded into the vendor</p><h2 id="proc">Proc Details</h2><h3 id="proc/allow_increase"><aside class="declaration">proc </aside>allow_increase<aside>(/<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/<a href="obj/item/clothing.html">clothing</a>/clothing_path)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/modular_skyrat/modules/modular_vending/code/vending.dm#L62"><img src="git.png" width="16" height="16" title="modular_skyrat/modules/modular_vending/code/vending.dm 62"></a></aside></h3><p>This proc checks for forbidden traits cause it'd be pretty bad to have 5 insuls available to assistants roundstart at the vendor!</p><h3 id="proc/atom_break"><aside class="parent"><a title="/atom" href="atom.html#proc/atom_break">↑</a></aside>atom_break<aside>(damage_flag)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L363"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 363"></a></aside></h3><p>Intentionally leaving out a case for zero credits as it should be covered by the vending machine's stock being full,
or covered by first case if items were returned.</p><h3 id="proc/build_inventories"><aside class="declaration">proc </aside>build_inventories<aside>(start_empty)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L448"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 448"></a></aside></h3><p>*Builds all available inventories for the vendor - standard, contraband and premium</p>
<ul>
<li>Arguments:</li>
<li>start_empty - bool to pass into build_inventory that determines whether a product entry starts with available stock or not</li>
</ul><h3 id="proc/build_inventory"><aside class="declaration">proc </aside>build_inventory<aside>(/list/productlist, /list/recordlist, /list/categories, start_empty)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L408"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 408"></a></aside></h3><p>Build the inventory of the vending machine from its product and record lists</p>
<p>This builds up a full set of /datum/data/vending_products from the product list of the vending machine type
Arguments:</p>
<ul>
<li>productlist - the list of products that need to be converted</li>
<li>recordlist - the list containing /datum/data/vending_product datums</li>
<li>categories - A list in the format of product_categories to source category from</li>
<li>startempty - should we set vending_product record amount from the product list (so it's prefilled at roundstart)</li>
</ul><h3 id="proc/build_products_from_categories"><aside class="declaration">proc </aside>build_products_from_categories<aside>()  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L468"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 468"></a></aside></h3><p>Populates list of products with categorized products</p><h3 id="proc/canLoadItem"><aside class="declaration">proc </aside>canLoadItem<aside>(/<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/loaded_item, /<a href="mob.html">mob</a>/user, send_message)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L1635"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 1635"></a></aside></h3><p>Are we able to load the item passed in</p>
<p>Arguments:</p>
<ul>
<li>loaded_item - the item being loaded</li>
<li>user - the user doing the loading</li>
<li>send_message - should we send a message to the user if the item can't be loaded? Either a to_chat or a speak depending on vending type.</li>
</ul><h3 id="proc/can_vend"><aside class="declaration">proc </aside>can_vend<aside>(user)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L1337"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 1337"></a></aside></h3><p>Whether this vendor can vend items or not.
arguments:
user - current customer</p><h3 id="proc/collect_records_for_static_data"><aside class="declaration">proc </aside>collect_records_for_static_data<aside>(/list/records, /list/categories, premium)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L1244"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 1244"></a></aside></h3><p>Returns a list of given product records of the vendor to be used in UI.
arguments:
records - list of records available
categories - list of categories available
premium - bool of whether a record should be priced by a custom/premium price or not</p><h3 id="proc/compartmentLoadAccessCheck"><aside class="declaration">proc </aside>compartmentLoadAccessCheck<aside>(/<a href="mob.html">mob</a>/user)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L1147"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 1147"></a></aside></h3><p>Is the passed in user allowed to load this vending machines compartments? This only is ran if we are using a /obj/item/storage/bag to load the vending machine, and not a dedicated restocker.</p>
<p>Arguments:</p>
<ul>
<li>user - mob that is doing the loading of the vending machine</li>
</ul><h3 id="proc/create_categories_from"><aside class="declaration">proc </aside>create_categories_from<aside>(name, icon, products)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L460"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 460"></a></aside></h3><p>Returns a list of data about the category
Arguments:
name - string for the name of the category
icon - string for the fontawesome icon to use in the UI for the category
products - list of products available in the category</p><h3 id="proc/deploy_credits"><aside class="declaration">proc </aside>deploy_credits<aside>()  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L1660"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 1660"></a></aside></h3><p>Drop credits when the vendor is attacked.</p><h3 id="proc/fetch_balance_to_use"><aside class="declaration">proc </aside>fetch_balance_to_use<aside>(/<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/<a href="obj/item/card.html">card</a>/<a href="obj/item/card/id.html">id</a>/passed_id)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L1485"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 1485"></a></aside></h3><p>Returns the balance that the vendor will use for proceeding payment. Most vendors would want to use the user's
card's account credits balance.
arguments:
passed_id - the id card that will be billed for the product</p><h3 id="proc/freebie"><aside class="declaration">proc </aside>freebie<aside>(freebies)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L778"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 778"></a></aside></h3><p>Dispenses free items from the standard stock.
Arguments:
freebies - number of free items to vend</p><h3 id="proc/loadingAttempt"><aside class="declaration">proc </aside>loadingAttempt<aside>(/<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/inserted_item, /<a href="mob.html">mob</a>/user)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L1117"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 1117"></a></aside></h3><p>Tries to insert the item into the vendor, and depending on whether the product is a part of the vendor's
stock or not, increments an already present product entry's available amount or creates a new entry.
arguments:
inserted_item - the item we're trying to insert
user - mob who's trying to insert the item</p><h3 id="proc/on_dispense"><aside class="declaration">proc </aside>on_dispense<aside>(/<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/vended_item)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L1476"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 1476"></a></aside></h3><p>A proc meant to perform custom behavior on newly dispensed items.</p><h3 id="proc/post_restock"><aside class="declaration">proc </aside>post_restock<aside>(/<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/user, restocked)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L560"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 560"></a></aside></h3><p>After-effects of refilling a vending machine from a refill canister</p>
<p>This takes the amount of products restocked and gives the user our contained credits if needed,
sending the user a fitting message.</p>
<p>Arguments:</p>
<ul>
<li>user - the user restocking us</li>
<li>restocked - the amount of items we've been refilled with</li>
</ul><h3 id="proc/pre_throw"><aside class="declaration">proc </aside>pre_throw<aside>(/<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/thrown_item)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L1604"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 1604"></a></aside></h3><p>A callback called before an item is tossed out</p>
<p>Override this if you need to do any special case handling</p>
<p>Arguments:</p>
<ul>
<li>thrown_item - obj/item being thrown</li>
</ul><h3 id="proc/proceed_payment"><aside class="declaration">proc </aside>proceed_payment<aside>(/<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/<a href="obj/item/card.html">card</a>/<a href="obj/item/card/id.html">id</a>/paying_id_card, /<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/mob_paying, /<a href="datum.html">datum</a>/<a href="datum/data.html">data</a>/<a href="datum/data/vending_product.html">vending_product</a>/product_to_vend, price_to_use)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L1496"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 1496"></a></aside></h3><p>Handles payment processing: discounts, logging, balance change etc.
arguments:
paying_id_card - the id card that will be billed for the product.
mob_paying - the mob that is trying to purchase the item.
product_to_vend - the product record of the item we're trying to vend.
price_to_use - price of the item we're trying to vend.</p><h3 id="proc/refill_inventory"><aside class="declaration">proc </aside>refill_inventory<aside>(/list/productlist, /list/recordlist)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L579"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 579"></a></aside></h3><p>Refill our inventory from the passed in product list into the record list</p>
<p>Arguments:</p>
<ul>
<li>productlist - list of types -&gt; amount</li>
<li>recordlist - existing record datums</li>
</ul><h3 id="proc/remove_products"><aside class="declaration">proc </aside>remove_products<aside>(/list/paths_to_remove)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/modular_skyrat/modules/modular_vending/code/wardrobes.dm#L176"><img src="git.png" width="16" height="16" title="modular_skyrat/modules/modular_vending/code/wardrobes.dm 176"></a></aside></h3><p>GHOST CAFE WARDROBES
Removes given list of products. Must be called before build_inventory() to actually prevent the records from being created.</p><h3 id="proc/reset_prices"><aside class="declaration">proc </aside>reset_prices<aside>(/list/recordlist, /list/premiumlist)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L487"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 487"></a></aside></h3><p>Reassign the prices of the vending machine as a result of the inflation value, as provided by SSeconomy</p>
<p>This rebuilds both /datum/data/vending_products lists for premium and standard products based on their most relevant pricing values.
Arguments:</p>
<ul>
<li>recordlist - the list of standard product datums in the vendor to refresh their prices.</li>
<li>premiumlist - the list of premium product datums in the vendor to refresh their prices.</li>
</ul><h3 id="proc/restock"><aside class="declaration">proc </aside>restock<aside>(/<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/<a href="obj/item/vending_refill.html">vending_refill</a>/canister)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L521"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 521"></a></aside></h3><p>Refill a vending machine from a refill canister</p>
<p>This takes the products from the refill canister and then fills the products, contraband and premium product categories</p>
<p>Arguments:</p>
<ul>
<li>canister - the vending canister we are refilling from</li>
</ul><h3 id="proc/select_colors"><aside class="declaration">proc </aside>select_colors<aside>(/list/params)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L1349"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 1349"></a></aside></h3><p>Brings up a color config menu for the picked greyscaled item</p><h3 id="proc/shock"><aside class="declaration">proc </aside>shock<aside>(/<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/user, shock_chance)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L1617"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 1617"></a></aside></h3><p>Shock the passed in user</p>
<p>This checks we have power and that the passed in prob is passed, then generates some sparks
and calls electrocute_mob on the user</p>
<p>Arguments:</p>
<ul>
<li>user - the user to shock</li>
<li>shock_chance - probability the shock happens</li>
</ul><h3 id="proc/speak"><aside class="declaration">proc </aside>speak<aside>(message)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L1547"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 1547"></a></aside></h3><p>Speak the given message verbally</p>
<p>Checks if the machine is powered and the message exists</p>
<p>Arguments:</p>
<ul>
<li>message - the message to speak</li>
</ul><h3 id="proc/throw_impact">throw_impact<aside>(/<a href="atom.html">atom</a>/hit_atom, /<a href="datum.html">datum</a>/<a href="datum/thrownthing.html">thrownthing</a>/throwingdatum)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L1654"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 1654"></a></aside></h3><p>Crush the mob that the vending machine got thrown at</p><h3 id="proc/throw_item"><aside class="declaration">proc </aside>throw_item<aside>()  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L1567"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 1567"></a></aside></h3><p>Throw an item from our internal inventory out in front of us</p>
<p>This is called when we are hacked, it selects a random product from the records that has an amount &gt; 0
This item is then created and tossed out in front of us with a visible message</p><h3 id="proc/tilt"><aside class="declaration">proc </aside>tilt<aside>(/<a href="atom.html">atom</a>/fatty, local_crit_chance, forced_crit)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L808"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 808"></a></aside></h3><p>Tilts ontop of the atom supplied, if crit is true some extra shit can happen. See [fall_and_crush] for return values.
Arguments:
fatty - atom to tilt the vendor onto
local_crit_chance - percent chance of a critical hit
forced_crit - specific critical hit case to use, if any</p><h3 id="proc/total_loaded_stock"><aside class="declaration">proc </aside>total_loaded_stock<aside>()  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L671"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 671"></a></aside></h3><p>Returns the total amount of items in the vending machine based on the product records and premium records, but not contraband</p><h3 id="proc/total_max_stock"><aside class="declaration">proc </aside>total_max_stock<aside>()  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L680"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 680"></a></aside></h3><p>Returns the total amount of items in the vending machine based on the product records and premium records, but not contraband</p><h3 id="proc/unbuild_inventory"><aside class="declaration">proc </aside>unbuild_inventory<aside>(/list/recordlist)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L611"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 611"></a></aside></h3><p>Given a record list, go through and return a list of products in format of type -&gt; amount
Arguments:
recordlist - list of records to unbuild products from</p><h3 id="proc/unbuild_inventory_into"><aside class="declaration">proc </aside>unbuild_inventory_into<aside>(/list/product_records, /list/products, /list/product_categories)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L625"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 625"></a></aside></h3><p>Unbuild product_records into categorized product lists to the machine's refill canister.
Does not handle contraband/premium products, only standard stock and any other categories used by the vendor(see: ClothesMate).
If a product has no category, puts it into standard stock category.
Arguments:
product_records - list of products of the vendor
products - list of products of the refill canister
product_categories - list of product categories of the refill canister</p><h3 id="proc/untilt"><aside class="declaration">proc </aside>untilt<aside>(/<a href="mob.html">mob</a>/user)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L1096"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 1096"></a></aside></h3><p>Rights the vendor up, unpinning mobs under it, if any.
Arguments:
user - mob that has untilted the vendor</p><h3 id="proc/update_canister"><aside class="declaration">proc </aside>update_canister<aside>()  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L593"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 593"></a></aside></h3><p>Set up a refill canister that matches this machine's products</p>
<p>This is used when the machine is deconstructed, so the items aren't &quot;lost&quot;</p><h3 id="proc/vend"><aside class="declaration">proc </aside>vend<aside>(/list/params, /list/greyscale_colors)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L1393"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 1393"></a></aside></h3><p>The entire shebang of vending the picked item. Processes the vending and initiates the payment for the item.
arguments:
greyscale_colors - greyscale config for the item we're about to vend, if any</p><h3 id="proc/vend_greyscale"><aside class="declaration">proc </aside>vend_greyscale<aside>(/list/params, /<a href="datum.html">datum</a>/<a href="datum/greyscale_modify_menu.html">greyscale_modify_menu</a>/menu)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/modules/vending/_vending.dm#L1383"><img src="git.png" width="16" height="16" title="code/modules/vending/_vending.dm 1383"></a></aside></h3><p>Vends a greyscale modified item.
arguments:
menu - greyscale config menu that has been used to vend the item</p></main><footer>tgstation.dme <a href="https://github.com/Skyrat-SS13/Skyrat-tg/tree/e507f9120bb0c3beecfe169d14193d90e7229a58">e507f91</a> (master) — <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.9.0</a></footer></body></html>