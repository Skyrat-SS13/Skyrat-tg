<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><base href="../../../"><link rel="stylesheet" href="dmdoc.css"><title>/datum/controller/subsystem/dynamic - /tg/ Station 13</title></head><body><header><a href="index.html">/tg/ Station 13</a> - <a href="index.html#modules">Modules</a> - <a href="index.html#types">Types</a> â€” <a href="datum/controller/subsystem/dynamic.html#var">Var Details</a> - <a href="datum/controller/subsystem/dynamic.html#proc">Proc Details</a></header><main><h1>dynamic <aside>/<a href="datum.html">datum</a>/<a href="datum/controller/subsystem.html">controller/subsystem</a>/<a href="datum/controller/subsystem/dynamic.html">dynamic</a></aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L25"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 25"></a></h1><table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/candidates">candidates</a></th><td>List of candidates used on roundstart rulesets.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/configuration">configuration</a></th><td>Dynamic configuration, loaded on pre_setup</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/current_midround_rulesets">current_midround_rulesets</a></th><td>The last drafted midround rulesets (without the current one included).
Used for choosing different midround injections.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/current_rules">current_rules</a></th><td>Rules that are processed, rule_process is called on the rules in this list.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/executed_rules">executed_rules</a></th><td>List of executed rulesets.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/forced_injection">forced_injection</a></th><td>If TRUE, the next player to latejoin will guarantee roll for a random latejoin antag
(this does not guarantee they get said antag roll, depending on preferences and circumstances)</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/forced_latejoin_rule">forced_latejoin_rule</a></th><td>Forced ruleset to be executed for the next latejoin.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/high_impact_ruleset_executed">high_impact_ruleset_executed</a></th><td>If a high impact ruleset was executed. Only one will run at a time in most circumstances.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/hijacked_random_event_injection_chance_modifier">hijacked_random_event_injection_chance_modifier</a></th><td>The extra chance multiplier that a heavy impact midround ruleset will run next time.
For example, if this is set to 50, then the next heavy roll will be about 50% more likely to happen.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/initial_round_start_budget">initial_round_start_budget</a></th><td>The initial round start budget for logging purposes, set once at the beginning of the round.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/last_midround_injection_attempt">last_midround_injection_attempt</a></th><td>The time when the last midround injection was attempted, whether or not it was successful</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/latejoin_delay_max">latejoin_delay_max</a></th><td>The maximum time the recurring latejoin ruleset timer is allowed to be.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/latejoin_delay_min">latejoin_delay_min</a></th><td>The minimum time the recurring latejoin ruleset timer is allowed to be.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/latejoin_injection_cooldown">latejoin_injection_cooldown</a></th><td>When world.time is over this number the mode tries to inject a latejoin ruleset.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/latejoin_roll_chance">latejoin_roll_chance</a></th><td>The chance for latejoins to roll when ready</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/latejoin_rules">latejoin_rules</a></th><td>List of latejoin rules used for selecting the rules.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/low_pop_maximum_threat">low_pop_maximum_threat</a></th><td>The maximum threat that can roll with <em>zero</em> players.
As the number of players approaches <code>low_pop_player_threshold</code>, the maximum
threat level will increase.
For example, if <code>low_pop_maximum_threat</code> is 50, <code>low_pop_player_threshold</code> is 20,
and the number of readied players is 10, then the highest threat that can roll is
lerp(50, 100, 10 / 20), AKA 75.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/low_pop_player_threshold">low_pop_player_threshold</a></th><td>If there are less than this many players readied, threat level will be lowered.
This number should be kept fairly low, as there are other measures that population
impacts Dynamic, such as the requirements variable on rulesets.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/max_threat_level">max_threat_level</a></th><td>A number between 0 and 100. The maximum amount of threat allowed to generate.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/mid_round_budget">mid_round_budget</a></th><td>Set at the beginning of the round. Spent by midrounds and latejoins.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/midround_heavy_lower_bound">midround_heavy_lower_bound</a></th><td>Any midround after this point is guaranteed to be heavy</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/midround_injection_timer_id">midround_injection_timer_id</a></th><td>The timer ID for the cancellable midround rule injection</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/midround_light_upper_bound">midround_light_upper_bound</a></th><td>Any midround before this point is guaranteed to be light</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/midround_lower_bound">midround_lower_bound</a></th><td>The low bound for the midround roll time splits.
This number influences where to place midround rolls, making this smaller
will make midround rolls more frequent, and vice versa.
A midround will never be able to roll before this.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/midround_median_frequency">midround_median_frequency</a></th><td>Desired median point for midrounds, plus or minus the midround_roll_distance.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/midround_roll_distance">midround_roll_distance</a></th><td>The distance between the chosen midround roll point (which is deterministic),
and when it can actually roll.
Basically, if this is set to 5 minutes, and a midround roll point is decided to be at 20 minutes,
then it can roll anywhere between 15 and 25 minutes.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/midround_rules">midround_rules</a></th><td>List of midround rules used for selecting the rules.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/midround_upper_bound">midround_upper_bound</a></th><td>The upper bound for the midround roll time splits.
This number influences where to place midround rolls, making this larger
will make midround rolls less frequent, and vice versa.
A midround will never be able to roll farther than this.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/only_ruleset_executed">only_ruleset_executed</a></th><td>If a only ruleset has been executed.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/peaceful_percentage">peaceful_percentage</a></th><td>How many percent of the rounds are more peaceful.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/pop_per_requirement">pop_per_requirement</a></th><td></td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/random_event_hijack_maximum">random_event_hijack_maximum</a></th><td>The maximum amount of time for antag random events to be hijacked.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/random_event_hijack_minimum">random_event_hijack_minimum</a></th><td>The minimum amount of time for antag random events to be hijacked.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/random_event_hijacked">random_event_hijacked</a></th><td>Whether or not a random event has been hijacked this midround cycle</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/round_start_budget">round_start_budget</a></th><td>Set at the beginning of the round. Spent by the mode to &quot;purchase&quot; rules. Everything else goes in the postround budget.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/roundend_threat_log">roundend_threat_log</a></th><td>Threat log shown on the roundend report. Should only list player-made edits.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/roundstart_pop_ready">roundstart_pop_ready</a></th><td>Number of players who were ready on roundstart.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/roundstart_split_curve_centre">roundstart_split_curve_centre</a></th><td>A number between -5 and +5.
Equivalent to threat_curve_centre, but for the budget split.
A negative value will weigh towards midround rulesets, and a positive
value will weight towards roundstart ones.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/roundstart_split_curve_width">roundstart_split_curve_width</a></th><td>A number between 0.5 and 4.
Equivalent to threat_curve_width, but for the budget split.
Higher value will favour more variance in splits and
lower value rounds closer to the average.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/shown_threat">shown_threat</a></th><td>The amount of threat shown on the piece of paper.
Can differ from the actual threat amount.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/snapshots">snapshots</a></th><td>A list of recorded &quot;snapshots&quot; of the round, stored in the dynamic.json log</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/threat_curve_centre">threat_curve_centre</a></th><td>A number between -5 and +5.
A negative value will give a more peaceful round and
a positive value will give a round with higher threat.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/threat_curve_width">threat_curve_width</a></th><td>A number between 0.5 and 4.
Higher value will favour extreme rounds and
lower value rounds closer to the average.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/threat_level">threat_level</a></th><td>The &quot;threat cap&quot;, threat shouldn't normally go above this and is used in ruleset calculations</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/threat_log">threat_log</a></th><td>Running information about the threat. Can store text or datum entries.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/threat_per_midround_roll">threat_per_midround_roll</a></th><td>The amount of threat per midround roll.
Basically, if this is set to 5, then for every 5 threat, one midround roll will be added.
The equation this is used in rounds up, meaning that if this is set to 5, and you have 6
threat, then you will get 2 midround rolls.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/waittime_h">waittime_h</a></th><td>What is the higher bound of when the roundstart announcement is sent out?</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#var/waittime_l">waittime_l</a></th><td>What is the lower bound of when the roundstart announcement is sent out?</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#proc/admin_cancel_midround">admin_cancel_midround</a></th><td>Fired when an admin cancels the current midround injection.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#proc/admin_different_midround">admin_different_midround</a></th><td>Fired when an admin requests a different midround injection.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#proc/alternate_midround_injection">alternate_midround_injection</a></th><td>If a midround injection fails to run, this can be called by the particular rule (if required) to attempt an alternate.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#proc/check_blocking">check_blocking</a></th><td>Checks if a type in blocking_list is in rule_list.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#proc/configure_ruleset">configure_ruleset</a></th><td>Apply configurations to rule.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#proc/configure_station_trait">configure_station_trait</a></th><td>Apply configuration for station trait costs</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#proc/configure_station_trait_costs">configure_station_trait_costs</a></th><td>Get station traits and call for their config</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#proc/create_threat">create_threat</a></th><td>Generate threat and increase the threat_level if it goes beyond, capped at 100</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#proc/execute_midround_latejoin_rule">execute_midround_latejoin_rule</a></th><td>Mainly here to facilitate delayed rulesets. All midround/latejoin rulesets are executed with a timered callback to this proc.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#proc/execute_midround_rule">execute_midround_rule</a></th><td>Fired after admins do not cancel a midround injection.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#proc/execute_roundstart_rule">execute_roundstart_rule</a></th><td>Mainly here to facilitate delayed rulesets. All roundstart rulesets are executed with a timered callback to this proc.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#proc/generate_advisory_level">generate_advisory_level</a></th><td>Generate the advisory level depending on the shown threat level.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#proc/generate_budgets">generate_budgets</a></th><td>Divides threat budget based on the server config</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#proc/generate_threat">generate_threat</a></th><td>Generates the threat level using lorentz distribution and assigns peaceful_percentage.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#proc/generate_unfavourable_events">generate_unfavourable_events</a></th><td>Filter the below list by which events can actually run on this map</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#proc/generate_unfavourable_heavy_rulesets">generate_unfavourable_heavy_rulesets</a></th><td>Return a valid heavy dynamic ruleset, or an empty list if there's no time to run any rulesets</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#proc/get_heavy_midround_injection_chance">get_heavy_midround_injection_chance</a></th><td>Gets the chance for a heavy ruleset midround injection, the dry_run argument is only used for forced injection.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#proc/handle_executing_latejoin">handle_executing_latejoin</a></th><td>This proc handles the execution of a latejoin ruleset, including removing it from latejoin rulesets if not repeatable,
upping the injection cooldown, and starting a timer to execute the ruleset on delay.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#proc/init_rulesets">init_rulesets</a></th><td>Returns a list of the provided rulesets.
Configures their variables to match config.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#proc/log_dynamic_and_announce">log_dynamic_and_announce</a></th><td>Log to dynamic and message admins</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#proc/lorentz_to_amount">lorentz_to_amount</a></th><td>Returns the comulative distribution of threat centre and width, and a random location of -5 to 5
plus or minus the otherwise unattainable lower and upper percentiles. All multiplied by the maximum
threat and then rounded to the nearest interval.
rand() calls without arguments returns a value between 0 and 1, allowing for smaller intervals.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#proc/make_antag_chance">make_antag_chance</a></th><td>Handles late-join antag assignments</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#proc/new_snapshot">new_snapshot</a></th><td>Creates a new snapshot with the given rulesets chosen, and writes to the JSON output.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#proc/next_midround_injection">next_midround_injection</a></th><td>Determines the next midround injection attempt based on the set median and roll distance.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#proc/pick_midround_rule">pick_midround_rule</a></th><td>Executes a random midround ruleset from the list of drafted rules.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#proc/pick_ruleset">pick_ruleset</a></th><td>From a list of rulesets, returns one based on weight and availability.
Mutates the list that is passed into it to remove invalid rules.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#proc/picking_roundstart_rule">picking_roundstart_rule</a></th><td>Initializes the round start ruleset provided to it. Returns how much threat to spend.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#proc/picking_specific_rule">picking_specific_rule</a></th><td>An experimental proc to allow admins to call rules on the fly or have rules call other rules.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#proc/refund_threat">refund_threat</a></th><td>Refund threat, but no more than threat_level.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#proc/remove_from_list">remove_from_list</a></th><td>Removes type from the list</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#proc/rigged_roundstart">rigged_roundstart</a></th><td>A simple roundstart proc used when dynamic_forced_roundstart_ruleset has rules in it.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#proc/setup_rulesets">setup_rulesets</a></th><td>Initializes the internal ruleset variables</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#proc/spend_midround_budget">spend_midround_budget</a></th><td>Expend midround threat, can't fall under 0.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#proc/spend_roundstart_budget">spend_roundstart_budget</a></th><td>Expend round start threat, can't fall under 0.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#proc/unfavorable_situation">unfavorable_situation</a></th><td>An easy interface to make...<em>waves hands</em> bad things happen.
This is used for impactful events like traitors hacking and creating more threat, or a revolutions victory.
It tries to spawn a heavy midround if possible, otherwise it will trigger a &quot;bad&quot; random event after a short period.
Calling this function will not use up any threat.</td></tr><tr><th><a href="datum/controller/subsystem/dynamic.html#proc/update_log">update_log</a></th><td>Updates the log for the current snapshots.</td></tr></table><h2 id="var">Var Details</h2><h3 id="var/candidates"><aside class="declaration">var </aside>candidates <aside>â€“ /list</aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L63"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 63"></a></h3><p>List of candidates used on roundstart rulesets.</p><h3 id="var/configuration"><aside class="declaration">var </aside>configuration <aside>â€“ /list</aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L80"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 80"></a></h3><p>Dynamic configuration, loaded on pre_setup</p><h3 id="var/current_midround_rulesets"><aside class="declaration">var </aside>current_midround_rulesets <aside>â€“ /list</aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L194"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 194"></a></h3><p>The last drafted midround rulesets (without the current one included).
Used for choosing different midround injections.</p><h3 id="var/current_rules"><aside class="declaration">var </aside>current_rules <aside>â€“ /list</aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L65"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 65"></a></h3><p>Rules that are processed, rule_process is called on the rules in this list.</p><h3 id="var/executed_rules"><aside class="declaration">var </aside>executed_rules <aside>â€“ /list</aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L67"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 67"></a></h3><p>List of executed rulesets.</p><h3 id="var/forced_injection"><aside class="declaration">var </aside>forced_injection <aside>â€“ </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L70"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 70"></a></h3><p>If TRUE, the next player to latejoin will guarantee roll for a random latejoin antag
(this does not guarantee they get said antag roll, depending on preferences and circumstances)</p><h3 id="var/forced_latejoin_rule"><aside class="declaration">var </aside>forced_latejoin_rule <aside>â€“ /<a href="datum.html">datum</a>/<a href="datum/dynamic_ruleset.html">dynamic_ruleset</a>/latejoin</aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L72"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 72"></a></h3><p>Forced ruleset to be executed for the next latejoin.</p><h3 id="var/high_impact_ruleset_executed"><aside class="declaration">var </aside>high_impact_ruleset_executed <aside>â€“ </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L76"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 76"></a></h3><p>If a high impact ruleset was executed. Only one will run at a time in most circumstances.</p><h3 id="var/hijacked_random_event_injection_chance_modifier"><aside class="declaration">var </aside>hijacked_random_event_injection_chance_modifier <aside>â€“ </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L154"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 154"></a></h3><p>The extra chance multiplier that a heavy impact midround ruleset will run next time.
For example, if this is set to 50, then the next heavy roll will be about 50% more likely to happen.</p><h3 id="var/initial_round_start_budget"><aside class="declaration">var </aside>initial_round_start_budget <aside>â€“ </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L41"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 41"></a></h3><p>The initial round start budget for logging purposes, set once at the beginning of the round.</p><h3 id="var/last_midround_injection_attempt"><aside class="declaration">var </aside>last_midround_injection_attempt <aside>â€“ </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L184"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 184"></a></h3><p>The time when the last midround injection was attempted, whether or not it was successful</p><h3 id="var/latejoin_delay_max"><aside class="declaration">var </aside>latejoin_delay_max <aside>â€“ </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L89"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 89"></a></h3><p>The maximum time the recurring latejoin ruleset timer is allowed to be.</p><h3 id="var/latejoin_delay_min"><aside class="declaration">var </aside>latejoin_delay_min <aside>â€“ </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L86"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 86"></a></h3><p>The minimum time the recurring latejoin ruleset timer is allowed to be.</p><h3 id="var/latejoin_injection_cooldown"><aside class="declaration">var </aside>latejoin_injection_cooldown <aside>â€“ </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L83"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 83"></a></h3><p>When world.time is over this number the mode tries to inject a latejoin ruleset.</p><h3 id="var/latejoin_roll_chance"><aside class="declaration">var </aside>latejoin_roll_chance <aside>â€“ </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L176"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 176"></a></h3><p>The chance for latejoins to roll when ready</p><h3 id="var/latejoin_rules"><aside class="declaration">var </aside>latejoin_rules <aside>â€“ /list</aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L48"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 48"></a></h3><p>List of latejoin rules used for selecting the rules.</p><h3 id="var/low_pop_maximum_threat"><aside class="declaration">var </aside>low_pop_maximum_threat <aside>â€“ </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L173"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 173"></a></h3><p>The maximum threat that can roll with <em>zero</em> players.
As the number of players approaches <code>low_pop_player_threshold</code>, the maximum
threat level will increase.
For example, if <code>low_pop_maximum_threat</code> is 50, <code>low_pop_player_threshold</code> is 20,
and the number of readied players is 10, then the highest threat that can roll is
lerp(50, 100, 10 / 20), AKA 75.</p><h3 id="var/low_pop_player_threshold"><aside class="declaration">var </aside>low_pop_player_threshold <aside>â€“ </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L165"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 165"></a></h3><p>If there are less than this many players readied, threat level will be lowered.
This number should be kept fairly low, as there are other measures that population
impacts Dynamic, such as the requirements variable on rulesets.</p><h3 id="var/max_threat_level"><aside class="declaration">var </aside>max_threat_level <aside>â€“ </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L150"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 150"></a></h3><p>A number between 0 and 100. The maximum amount of threat allowed to generate.</p><h3 id="var/mid_round_budget"><aside class="declaration">var </aside>mid_round_budget <aside>â€“ </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L38"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 38"></a></h3><p>Set at the beginning of the round. Spent by midrounds and latejoins.</p><h3 id="var/midround_heavy_lower_bound"><aside class="declaration">var </aside>midround_heavy_lower_bound <aside>â€“ </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L160"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 160"></a></h3><p>Any midround after this point is guaranteed to be heavy</p><h3 id="var/midround_injection_timer_id"><aside class="declaration">var </aside>midround_injection_timer_id <aside>â€“ </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L190"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 190"></a></h3><p>The timer ID for the cancellable midround rule injection</p><h3 id="var/midround_light_upper_bound"><aside class="declaration">var </aside>midround_light_upper_bound <aside>â€“ </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L157"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 157"></a></h3><p>Any midround before this point is guaranteed to be light</p><h3 id="var/midround_lower_bound"><aside class="declaration">var </aside>midround_lower_bound <aside>â€“ </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L95"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 95"></a></h3><p>The low bound for the midround roll time splits.
This number influences where to place midround rolls, making this smaller
will make midround rolls more frequent, and vice versa.
A midround will never be able to roll before this.</p><h3 id="var/midround_median_frequency"><aside class="declaration">var </aside>midround_median_frequency <aside>â€“ </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/modular_skyrat/master_files/code/game/gamemodes/dynamic.dm#L61"><img src="git.png" width="16" height="16" title="modular_skyrat/master_files/code/game/gamemodes/dynamic.dm 61"></a></h3><p>Desired median point for midrounds, plus or minus the midround_roll_distance.</p><h3 id="var/midround_roll_distance"><aside class="declaration">var </aside>midround_roll_distance <aside>â€“ </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L107"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 107"></a></h3><p>The distance between the chosen midround roll point (which is deterministic),
and when it can actually roll.
Basically, if this is set to 5 minutes, and a midround roll point is decided to be at 20 minutes,
then it can roll anywhere between 15 and 25 minutes.</p><h3 id="var/midround_rules"><aside class="declaration">var </aside>midround_rules <aside>â€“ /list</aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L50"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 50"></a></h3><p>List of midround rules used for selecting the rules.</p><h3 id="var/midround_upper_bound"><aside class="declaration">var </aside>midround_upper_bound <aside>â€“ </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L101"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 101"></a></h3><p>The upper bound for the midround roll time splits.
This number influences where to place midround rolls, making this larger
will make midround rolls less frequent, and vice versa.
A midround will never be able to roll farther than this.</p><h3 id="var/only_ruleset_executed"><aside class="declaration">var </aside>only_ruleset_executed <aside>â€“ </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L78"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 78"></a></h3><p>If a only ruleset has been executed.</p><h3 id="var/peaceful_percentage"><aside class="declaration">var </aside>peaceful_percentage <aside>â€“ </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L74"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 74"></a></h3><p>How many percent of the rounds are more peaceful.</p><h3 id="var/pop_per_requirement"><aside class="declaration">var </aside>pop_per_requirement <aside>â€“ </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L59"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 59"></a></h3><ul>
<li><h1 id="pop-range-per-requirement">Pop range per requirement.</h1>
<pre><code>* If the value is five the range is:
* 0-4, 5-9, 10-14, 15-19, 20-24, 25-29, 30-34, 35-39, 40-54, 45+
* If it is six the range is:
* 0-5, 6-11, 12-17, 18-23, 24-29, 30-35, 36-41, 42-47, 48-53, 54+
* If it is seven the range is:
* 0-6, 7-13, 14-20, 21-27, 28-34, 35-41, 42-48, 49-55, 56-62, 63+
</code></pre>
</li>
</ul><h3 id="var/random_event_hijack_maximum"><aside class="declaration">var </aside>random_event_hijack_maximum <aside>â€“ </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L141"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 141"></a></h3><p>The maximum amount of time for antag random events to be hijacked.</p><h3 id="var/random_event_hijack_minimum"><aside class="declaration">var </aside>random_event_hijack_minimum <aside>â€“ </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L138"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 138"></a></h3><p>The minimum amount of time for antag random events to be hijacked.</p><h3 id="var/random_event_hijacked"><aside class="declaration">var </aside>random_event_hijacked <aside>â€“ </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L187"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 187"></a></h3><p>Whether or not a random event has been hijacked this midround cycle</p><h3 id="var/round_start_budget"><aside class="declaration">var </aside>round_start_budget <aside>â€“ </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L35"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 35"></a></h3><p>Set at the beginning of the round. Spent by the mode to &quot;purchase&quot; rules. Everything else goes in the postround budget.</p><h3 id="var/roundend_threat_log"><aside class="declaration">var </aside>roundend_threat_log <aside>â€“ /list</aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L46"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 46"></a></h3><p>Threat log shown on the roundend report. Should only list player-made edits.</p><h3 id="var/roundstart_pop_ready"><aside class="declaration">var </aside>roundstart_pop_ready <aside>â€“ </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L61"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 61"></a></h3><p>Number of players who were ready on roundstart.</p><h3 id="var/roundstart_split_curve_centre"><aside class="declaration">var </aside>roundstart_split_curve_centre <aside>â€“ </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L129"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 129"></a></h3><p>A number between -5 and +5.
Equivalent to threat_curve_centre, but for the budget split.
A negative value will weigh towards midround rulesets, and a positive
value will weight towards roundstart ones.</p><h3 id="var/roundstart_split_curve_width"><aside class="declaration">var </aside>roundstart_split_curve_width <aside>â€“ </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L135"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 135"></a></h3><p>A number between 0.5 and 4.
Equivalent to threat_curve_width, but for the budget split.
Higher value will favour more variance in splits and
lower value rounds closer to the average.</p><h3 id="var/shown_threat"><aside class="declaration">var </aside>shown_threat <aside>â€“ </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L198"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 198"></a></h3><p>The amount of threat shown on the piece of paper.
Can differ from the actual threat amount.</p><h3 id="var/snapshots"><aside class="declaration">var </aside>snapshots <aside>â€“ /list/datum/dynamic_snapshot</aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L181"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 181"></a></h3><p>A list of recorded &quot;snapshots&quot; of the round, stored in the dynamic.json log</p><h3 id="var/threat_curve_centre"><aside class="declaration">var </aside>threat_curve_centre <aside>â€“ </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L118"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 118"></a></h3><p>A number between -5 and +5.
A negative value will give a more peaceful round and
a positive value will give a round with higher threat.</p><h3 id="var/threat_curve_width"><aside class="declaration">var </aside>threat_curve_width <aside>â€“ </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L123"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 123"></a></h3><p>A number between 0.5 and 4.
Higher value will favour extreme rounds and
lower value rounds closer to the average.</p><h3 id="var/threat_level"><aside class="declaration">var </aside>threat_level <aside>â€“ </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L32"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 32"></a></h3><p>The &quot;threat cap&quot;, threat shouldn't normally go above this and is used in ruleset calculations</p><h3 id="var/threat_log"><aside class="declaration">var </aside>threat_log <aside>â€“ /list</aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L44"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 44"></a></h3><p>Running information about the threat. Can store text or datum entries.</p><h3 id="var/threat_per_midround_roll"><aside class="declaration">var </aside>threat_per_midround_roll <aside>â€“ </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L113"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 113"></a></h3><p>The amount of threat per midround roll.
Basically, if this is set to 5, then for every 5 threat, one midround roll will be added.
The equation this is used in rounds up, meaning that if this is set to 5, and you have 6
threat, then you will get 2 midround rolls.</p><h3 id="var/waittime_h"><aside class="declaration">var </aside>waittime_h <aside>â€“ </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L147"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 147"></a></h3><p>What is the higher bound of when the roundstart announcement is sent out?</p><h3 id="var/waittime_l"><aside class="declaration">var </aside>waittime_l <aside>â€“ </aside> <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L144"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 144"></a></h3><p>What is the lower bound of when the roundstart announcement is sent out?</p><h2 id="proc">Proc Details</h2><h3 id="proc/admin_cancel_midround"><aside class="declaration">proc </aside>admin_cancel_midround<aside>(/<a href="mob.html">mob</a>/user, timer_id)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/ruleset_picking.dm#L132"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/ruleset_picking.dm 132"></a></aside></h3><p>Fired when an admin cancels the current midround injection.</p><h3 id="proc/admin_different_midround"><aside class="declaration">proc </aside>admin_different_midround<aside>(/<a href="mob.html">mob</a>/user, timer_id)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/ruleset_picking.dm#L143"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/ruleset_picking.dm 143"></a></aside></h3><p>Fired when an admin requests a different midround injection.</p><h3 id="proc/alternate_midround_injection"><aside class="declaration">proc </aside>alternate_midround_injection<aside>()  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/modular_skyrat/master_files/code/game/gamemodes/dynamic.dm#L93"><img src="git.png" width="16" height="16" title="modular_skyrat/master_files/code/game/gamemodes/dynamic.dm 93"></a></aside></h3><p>If a midround injection fails to run, this can be called by the particular rule (if required) to attempt an alternate.</p><h3 id="proc/check_blocking"><aside class="declaration">proc </aside>check_blocking<aside>(/list/blocking_list, /list/rule_list)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L854"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 854"></a></aside></h3><p>Checks if a type in blocking_list is in rule_list.</p><h3 id="proc/configure_ruleset"><aside class="declaration">proc </aside>configure_ruleset<aside>(/<a href="datum.html">datum</a>/<a href="datum/dynamic_ruleset.html">dynamic_ruleset</a>/ruleset)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L935"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 935"></a></aside></h3><p>Apply configurations to rule.</p><h3 id="proc/configure_station_trait"><aside class="declaration">proc </aside>configure_station_trait<aside>(/<a href="datum.html">datum</a>/<a href="datum/station_trait.html">station_trait</a>/station_trait)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L972"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 972"></a></aside></h3><p>Apply configuration for station trait costs</p><h3 id="proc/configure_station_trait_costs"><aside class="declaration">proc </aside>configure_station_trait_costs<aside>()  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L965"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 965"></a></aside></h3><p>Get station traits and call for their config</p><h3 id="proc/create_threat"><aside class="declaration">proc </aside>create_threat<aside>(gain, /list/threat_log, reason)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L989"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 989"></a></aside></h3><p>Generate threat and increase the threat_level if it goes beyond, capped at 100</p><h3 id="proc/execute_midround_latejoin_rule"><aside class="declaration">proc </aside>execute_midround_latejoin_rule<aside>(sent_rule)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/ruleset_picking.dm#L106"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/ruleset_picking.dm 106"></a></aside></h3><p>Mainly here to facilitate delayed rulesets. All midround/latejoin rulesets are executed with a timered callback to this proc.</p><h3 id="proc/execute_midround_rule"><aside class="declaration">proc </aside>execute_midround_rule<aside>(/<a href="datum.html">datum</a>/<a href="datum/dynamic_ruleset.html">dynamic_ruleset</a>/rule)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/ruleset_picking.dm#L98"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/ruleset_picking.dm 98"></a></aside></h3><p>Fired after admins do not cancel a midround injection.</p><h3 id="proc/execute_roundstart_rule"><aside class="declaration">proc </aside>execute_roundstart_rule<aside>(sent_rule)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L775"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 775"></a></aside></h3><p>Mainly here to facilitate delayed rulesets. All roundstart rulesets are executed with a timered callback to this proc.</p><h3 id="proc/generate_advisory_level"><aside class="declaration">proc </aside>generate_advisory_level<aside>()  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L377"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 377"></a></aside></h3><p>Generate the advisory level depending on the shown threat level.</p><h3 id="proc/generate_budgets"><aside class="declaration">proc </aside>generate_budgets<aside>()  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/modular_skyrat/master_files/code/game/gamemodes/dynamic.dm#L64"><img src="git.png" width="16" height="16" title="modular_skyrat/master_files/code/game/gamemodes/dynamic.dm 64"></a></aside></h3><p>Divides threat budget based on the server config</p><h3 id="proc/generate_threat"><aside class="declaration">proc </aside>generate_threat<aside>()  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L443"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 443"></a></aside></h3><p>Generates the threat level using lorentz distribution and assigns peaceful_percentage.</p><h3 id="proc/generate_unfavourable_events"><aside class="declaration">proc </aside>generate_unfavourable_events<aside>()  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic_unfavorable_situation.dm#L61"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic_unfavorable_situation.dm 61"></a></aside></h3><p>Filter the below list by which events can actually run on this map</p><h3 id="proc/generate_unfavourable_heavy_rulesets"><aside class="declaration">proc </aside>generate_unfavourable_heavy_rulesets<aside>()  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic_unfavorable_situation.dm#L27"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic_unfavorable_situation.dm 27"></a></aside></h3><p>Return a valid heavy dynamic ruleset, or an empty list if there's no time to run any rulesets</p><h3 id="proc/get_heavy_midround_injection_chance"><aside class="declaration">proc </aside>get_heavy_midround_injection_chance<aside>(dry_run)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/modular_skyrat/master_files/code/game/gamemodes/dynamic.dm#L73"><img src="git.png" width="16" height="16" title="modular_skyrat/master_files/code/game/gamemodes/dynamic.dm 73"></a></aside></h3><p>Gets the chance for a heavy ruleset midround injection, the dry_run argument is only used for forced injection.</p><h3 id="proc/handle_executing_latejoin"><aside class="declaration">proc </aside>handle_executing_latejoin<aside>(/<a href="datum.html">datum</a>/<a href="datum/dynamic_ruleset.html">dynamic_ruleset</a>/ruleset, /<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/<a href="mob/living/carbon.html">carbon</a>/<a href="mob/living/carbon/human.html">human</a>/only_candidate, forced)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L915"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 915"></a></aside></h3><p>This proc handles the execution of a latejoin ruleset, including removing it from latejoin rulesets if not repeatable,
upping the injection cooldown, and starting a timer to execute the ruleset on delay.</p><h3 id="proc/init_rulesets"><aside class="declaration">proc </aside>init_rulesets<aside>(ruleset_subtype)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L660"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 660"></a></aside></h3><p>Returns a list of the provided rulesets.
Configures their variables to match config.</p><h3 id="proc/log_dynamic_and_announce"><aside class="declaration">proc </aside>log_dynamic_and_announce<aside>(text)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/__HELPERS/logging/dynamic.dm#L2"><img src="git.png" width="16" height="16" title="code/__HELPERS/logging/dynamic.dm 2"></a></aside></h3><p>Log to dynamic and message admins</p><h3 id="proc/lorentz_to_amount"><aside class="declaration">proc </aside>lorentz_to_amount<aside>(centre, scale, max_threat, interval)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L1022"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 1022"></a></aside></h3><p>Returns the comulative distribution of threat centre and width, and a random location of -5 to 5
plus or minus the otherwise unattainable lower and upper percentiles. All multiplied by the maximum
threat and then rounded to the nearest interval.
rand() calls without arguments returns a value between 0 and 1, allowing for smaller intervals.</p><h3 id="proc/make_antag_chance"><aside class="declaration">proc </aside>make_antag_chance<aside>(/<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/<a href="mob/living/carbon.html">carbon</a>/<a href="mob/living/carbon/human.html">human</a>/newPlayer)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L865"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 865"></a></aside></h3><p>Handles late-join antag assignments</p><h3 id="proc/new_snapshot"><aside class="declaration">proc </aside>new_snapshot<aside>(/<a href="datum.html">datum</a>/<a href="datum/dynamic_ruleset.html">dynamic_ruleset</a>/ruleset_chosen)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic_logging.dm#L87"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic_logging.dm 87"></a></aside></h3><p>Creates a new snapshot with the given rulesets chosen, and writes to the JSON output.</p><h3 id="proc/next_midround_injection"><aside class="declaration">proc </aside>next_midround_injection<aside>()  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/modular_skyrat/master_files/code/game/gamemodes/dynamic.dm#L81"><img src="git.png" width="16" height="16" title="modular_skyrat/master_files/code/game/gamemodes/dynamic.dm 81"></a></aside></h3><p>Determines the next midround injection attempt based on the set median and roll distance.</p><h3 id="proc/pick_midround_rule"><aside class="declaration">proc </aside>pick_midround_rule<aside>(/list/drafted_rules, description)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/ruleset_picking.dm#L55"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/ruleset_picking.dm 55"></a></aside></h3><p>Executes a random midround ruleset from the list of drafted rules.</p><h3 id="proc/pick_ruleset"><aside class="declaration">proc </aside>pick_ruleset<aside>(/list/drafted_rules, max_allowed_attempts)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/ruleset_picking.dm#L11"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/ruleset_picking.dm 11"></a></aside></h3><p>From a list of rulesets, returns one based on weight and availability.
Mutates the list that is passed into it to remove invalid rules.</p>
<ul>
<li>max_allowed_attempts - Allows you to configure how many times the proc will attempt to pick a ruleset before giving up.</li>
</ul><h3 id="proc/picking_roundstart_rule"><aside class="declaration">proc </aside>picking_roundstart_rule<aside>(/<a href="datum.html">datum</a>/<a href="datum/dynamic_ruleset.html">dynamic_ruleset</a>/<a href="datum/dynamic_ruleset/roundstart.html">roundstart</a>/ruleset, scaled_times, forced)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L756"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 756"></a></aside></h3><p>Initializes the round start ruleset provided to it. Returns how much threat to spend.</p><h3 id="proc/picking_specific_rule"><aside class="declaration">proc </aside>picking_specific_rule<aside>(ruletype, forced, ignore_cost)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L790"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 790"></a></aside></h3><p>An experimental proc to allow admins to call rules on the fly or have rules call other rules.</p><h3 id="proc/refund_threat"><aside class="declaration">proc </aside>refund_threat<aside>(regain)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L985"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 985"></a></aside></h3><p>Refund threat, but no more than threat_level.</p><h3 id="proc/remove_from_list"><aside class="declaration">proc </aside>remove_from_list<aside>(/list/type_list, type)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L847"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 847"></a></aside></h3><p>Removes type from the list</p><h3 id="proc/rigged_roundstart"><aside class="declaration">proc </aside>rigged_roundstart<aside>()  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L677"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 677"></a></aside></h3><p>A simple roundstart proc used when dynamic_forced_roundstart_ruleset has rules in it.</p><h3 id="proc/setup_rulesets"><aside class="declaration">proc </aside>setup_rulesets<aside>()  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L654"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 654"></a></aside></h3><p>Initializes the internal ruleset variables</p><h3 id="proc/spend_midround_budget"><aside class="declaration">proc </aside>spend_midround_budget<aside>(cost, /list/threat_log, reason)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L1009"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 1009"></a></aside></h3><p>Expend midround threat, can't fall under 0.</p><h3 id="proc/spend_roundstart_budget"><aside class="declaration">proc </aside>spend_roundstart_budget<aside>(cost, /list/threat_log, reason)  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic.dm#L1003"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic.dm 1003"></a></aside></h3><p>Expend round start threat, can't fall under 0.</p><h3 id="proc/unfavorable_situation"><aside class="declaration">proc </aside>unfavorable_situation<aside>()  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic_unfavorable_situation.dm#L5"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic_unfavorable_situation.dm 5"></a></aside></h3><p>An easy interface to make...<em>waves hands</em> bad things happen.
This is used for impactful events like traitors hacking and creating more threat, or a revolutions victory.
It tries to spawn a heavy midround if possible, otherwise it will trigger a &quot;bad&quot; random event after a short period.
Calling this function will not use up any threat.</p><h3 id="proc/update_log"><aside class="declaration">proc </aside>update_log<aside>()  <a href="https://github.com/Skyrat-SS13/Skyrat-tg/blob/e507f9120bb0c3beecfe169d14193d90e7229a58/code/controllers/subsystem/dynamic/dynamic_logging.dm#L72"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/dynamic/dynamic_logging.dm 72"></a></aside></h3><p>Updates the log for the current snapshots.</p></main><footer>tgstation.dme <a href="https://github.com/Skyrat-SS13/Skyrat-tg/tree/e507f9120bb0c3beecfe169d14193d90e7229a58">e507f91</a> (master) â€” <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.9.0</a></footer></body></html>